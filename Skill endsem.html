import React, { useState } from 'react';

export default function StudentMarksTable() {
  const [students] = useState([
    { name: 'Aarav', subject: 'Math', score: 88 },
    { name: 'Diya', subject: 'Science', score: 92 },
    { name: 'Karan', subject: 'English', score: 75 },
    { name: 'Meera', subject: 'Math', score: 64 },
    { name: 'Ishaan', subject: 'Science', score: 81 },
    { name: 'Riya', subject: 'English', score: 95 },
  ]);

  const [sortConfig, setSortConfig] = useState({ key: null, direction: 'asc' });
  const [subjectFilter, setSubjectFilter] = useState('');
  const [minScore, setMinScore] = useState('');
  const [maxScore, setMaxScore] = useState('');

  const sortedStudents = [...students].sort((a, b) => {
    if (!sortConfig.key) return 0;
    const order = sortConfig.direction === 'asc' ? 1 : -1;
    if (a[sortConfig.key] < b[sortConfig.key]) return -1 * order;
    if (a[sortConfig.key] > b[sortConfig.key]) return 1 * order;
    return 0;
  });

  const filteredStudents = sortedStudents.filter((s) => {
    const subjectMatch = s.subject.toLowerCase().includes(subjectFilter.toLowerCase());
    const minOk = minScore === '' || s.score >= parseInt(minScore);
    const maxOk = maxScore === '' || s.score <= parseInt(maxScore);
    return subjectMatch && minOk && maxOk;
  });

  const requestSort = (key) => {
    let direction = 'asc';
    if (sortConfig.key === key && sortConfig.direction === 'asc') {
      direction = 'desc';
    }
    setSortConfig({ key, direction });
  };

  return (
    <div className="p-6 max-w-3xl mx-auto">
      <h1 className="text-2xl font-bold mb-4 text-center">Student Marks Table</h1>

      {/* Filters */}
      <div className="flex flex-wrap gap-3 mb-4">
        <input
          type="text"
          placeholder="Filter by Subject"
          value={subjectFilter}
          onChange={(e) => setSubjectFilter(e.target.value)}
          className="border p-2 rounded w-full sm:w-1/3"
        />
        <input
          type="number"
          placeholder="Min Score"
          value={minScore}
          onChange={(e) => setMinScore(e.target.value)}
          className="border p-2 rounded w-1/4"
        />
        <input
          type="number"
          placeholder="Max Score"
          value={maxScore}
          onChange={(e) => setMaxScore(e.target.value)}
          className="border p-2 rounded w-1/4"
        />
      </div>

      {/* Table */}
      <table className="min-w-full border border-gray-300 rounded-lg">
        <thead className="bg-gray-200">
          <tr>
            {['name', 'subject', 'score'].map((col) => (
              <th
                key={col}
                onClick={() => requestSort(col)}
                className="py-2 px-4 text-left cursor-pointer hover:bg-gray-300"
              >
                {col.charAt(0).toUpperCase() + col.slice(1)}
                {sortConfig.key === col ? (sortConfig.direction === 'asc' ? ' ↑' : ' ↓') : ''}
              </th>
            ))}
          </tr>
        </thead>
        <tbody>
          {filteredStudents.length > 0 ? (
            filteredStudents.map((s, i) => (
              <tr key={i} className="border-t hover:bg-gray-100">
                <td className="py-2 px-4">{s.name}</td>
                <td className="py-2 px-4">{s.subject}</td>
                <td className="py-2 px-4">{s.score}</td>
              </tr>
            ))
          ) : (
            <tr>
              <td colSpan="3" className="text-center py-3 text-gray-500">
                No records found
              </td>
            </tr>
          )}
        </tbody>
      </table>
    </div>
  );
}
